"use strict";(self["webpackChunkinventory_management_system"]=self["webpackChunkinventory_management_system"]||[]).push([[90],{700:function(e,s,r){r.r(s),r.d(s,{default:function(){return U}});var t=r(3396);const a=e=>((0,t.dD)("data-v-0d195a8c"),e=e(),(0,t.Cn)(),e),i={class:"mainContainer"},o=a((()=>(0,t._)("span",null,"添加用户",-1))),l=a((()=>(0,t._)("span",null,"导出表格",-1))),u=a((()=>(0,t._)("span",null,"批量删除",-1))),m={"slot:footer":"",class:"dialog-footer",style:{"padding-left":"0.8rem"}};function n(e,s,r,a,n,d){const c=(0,t.up)("el-breadcrumb-item"),p=(0,t.up)("el-breadcrumb"),h=(0,t.up)("el-button"),g=(0,t.up)("el-input"),w=(0,t.up)("el-col"),f=(0,t.up)("el-icon"),T=(0,t.up)("el-row"),P=(0,t.up)("el-table-column"),y=(0,t.up)("el-table"),b=(0,t.up)("PaginateView"),I=(0,t.up)("el-form-item"),W=(0,t.up)("el-form"),_=(0,t.up)("el-dialog"),z=(0,t.up)("el-card"),F=(0,t.Q2)("loading");return(0,t.wg)(),(0,t.iD)("div",i,[(0,t.Wm)(p,{"separator-class":"el-icon-arrow-right"},{default:(0,t.w5)((()=>[(0,t.Wm)(c,{to:{path:"/"}},{default:(0,t.w5)((()=>[(0,t.Uk)("首页")])),_:1}),(0,t.Wm)(c,null,{default:(0,t.w5)((()=>[(0,t.Uk)("用户管理")])),_:1})])),_:1}),(0,t.Wm)(z,{class:"cardContainer"},{default:(0,t.w5)((()=>[(0,t.Wm)(T,{gutter:20},{default:(0,t.w5)((()=>[(0,t.Wm)(w,{span:7},{default:(0,t.w5)((()=>[(0,t.Wm)(g,{placeholder:"请输入用户id（默认筛选全部）",style:{position:"relative"},clearable:"",onClear:d.showUser,modelValue:n.query,"onUpdate:modelValue":s[0]||(s[0]=e=>n.query=e)},{append:(0,t.w5)((()=>[(0,t.Wm)(h,{type:"primary",class:"iconfont icon-sousuo",onClick:d.showUser},null,8,["onClick"])])),_:1},8,["onClear","modelValue"])])),_:1}),(0,t.Wm)(w,{span:3.5},{default:(0,t.w5)((()=>[(0,t.Wm)(h,{type:"primary",onClick:s[1]||(s[1]=e=>d.handleEdit())},{default:(0,t.w5)((()=>[(0,t.Wm)(f,{class:"iconfont icon-tianjiayonghu"}),o])),_:1})])),_:1},8,["span"]),(0,t.Wm)(w,{span:3.5},{default:(0,t.w5)((()=>[(0,t.Wm)(h,{type:"primary",onClick:s[2]||(s[2]=e=>d.handleExport(n.userList))},{default:(0,t.w5)((()=>[(0,t.Wm)(f,{class:"iconfont icon-daochubiaoge"}),l])),_:1})])),_:1},8,["span"]),(0,t.Wm)(w,{span:3.5},{default:(0,t.w5)((()=>[(0,t.Wm)(h,{type:"danger",onClick:s[3]||(s[3]=e=>d.batchDelete(n.sels,d.showUser))},{default:(0,t.w5)((()=>[(0,t.Wm)(f,{class:"iconfont icon-shanchupiliangshanchu"}),u])),_:1})])),_:1},8,["span"])])),_:1}),(0,t.wy)(((0,t.wg)(),(0,t.j4)(y,{height:"3.2rem",onSortChange:d.sortChange,onSelectionChange:d.selsChange,data:n.userList.slice((n.pageparm.currentPage-1)*n.pageparm.pageSize,n.pageparm.currentPage*n.pageparm.pageSize),border:"","element-loading-text":"拼命加载中",stripe:"",style:{margin:"0.15rem 0rem 0.15rem 0rem","max-height":"3.2rem"}},{default:(0,t.w5)((()=>[(0,t.Wm)(P,{align:"center",type:"selection",width:"60"}),(0,t.Wm)(P,{align:"center",label:"用户id",prop:"userId","show-overflow-tooltip":!0,"min-width":"70"}),(0,t.Wm)(P,{align:"center",label:"用户名称",prop:"userName","show-overflow-tooltip":!0,"min-width":"110"}),(0,t.Wm)(P,{align:"center",label:"用户密码",prop:"userPassword","show-overflow-tooltip":!0,"min-width":"110"}),(0,t.Wm)(P,{align:"center",label:"用户权限",prop:"userPower","show-overflow-tooltip":!0,"filter-multiple":"","min-width":"100",sortable:"custom"}),(0,t.Wm)(P,{align:"center",label:"创建时间",prop:"createTime","show-overflow-tooltip":!0,formatter:d.formatDate,"min-width":"145",sortable:"custom"},null,8,["formatter"]),(0,t.Wm)(P,{align:"center",label:"更新时间",prop:"updateTime","show-overflow-tooltip":!0,formatter:d.formatDate,"min-width":"145",sortable:"custom"},null,8,["formatter"]),(0,t.Wm)(P,{align:"center",label:"操作","min-width":"140"},{default:(0,t.w5)((e=>[(0,t.Wm)(h,{size:"small",onClick:s=>d.handleEdit(e.$index,e.row)},{default:(0,t.w5)((()=>[(0,t.Uk)("编辑")])),_:2},1032,["onClick"]),(0,t.Wm)(h,{size:"small",type:"danger",onClick:s=>d.singleDelete(e.$index,e.row,d.showUser)},{default:(0,t.w5)((()=>[(0,t.Uk)("删除")])),_:2},1032,["onClick"])])),_:1})])),_:1},8,["onSortChange","onSelectionChange","data"])),[[F,n.loading]]),(0,t.Wm)(b,{"child-msg":n.pageparm,onCallFather:d.callFather},null,8,["child-msg","onCallFather"]),(0,t.Wm)(_,{title:n.title,modelValue:n.editFormVisible,"onUpdate:modelValue":s[8]||(s[8]=e=>n.editFormVisible=e),width:"30%","before-close":d.closeDialog},{default:(0,t.w5)((()=>[(0,t.Wm)(W,{"label-width":"1.2rem",model:n.editForm,rules:n.rules,ref:"editForm"},{default:(0,t.w5)((()=>[(0,t.Wm)(I,{label:"用户名称",prop:"userName"},{default:(0,t.w5)((()=>[(0,t.Wm)(g,{size:"small",modelValue:n.editForm.userName,"onUpdate:modelValue":s[4]||(s[4]=e=>n.editForm.userName=e),"auto-complete":"off",placeholder:"请输入用户名称"},null,8,["modelValue"])])),_:1}),(0,t.Wm)(I,{label:"用户密码",prop:"userPassword"},{default:(0,t.w5)((()=>[(0,t.Wm)(g,{size:"small",modelValue:n.editForm.userPassword,"onUpdate:modelValue":s[5]||(s[5]=e=>n.editForm.userPassword=e),"auto-complete":"off",placeholder:"请输入用户密码"},null,8,["modelValue"])])),_:1}),(0,t.Wm)(I,{label:"用户权限",prop:"userPower"},{default:(0,t.w5)((()=>[(0,t.Wm)(g,{size:"small",modelValue:n.editForm.userPower,"onUpdate:modelValue":s[6]||(s[6]=e=>n.editForm.userPower=e),modelModifiers:{number:!0},"auto-complete":"off",placeholder:"请输入用户权限(最高为999)"},null,8,["modelValue"])])),_:1})])),_:1},8,["model","rules"]),(0,t._)("div",m,[(0,t.Wm)(h,{style:{"margin-right":"0.6rem"},size:"small",onClick:d.closeDialog},{default:(0,t.w5)((()=>[(0,t.Uk)("取消")])),_:1},8,["onClick"]),(0,t.Wm)(h,{size:"small",type:"primary",loading:n.loading,class:"title",onClick:s[7]||(s[7]=e=>{d.submitForm(n.editForm,d.showUser,n.title),d.closeDialog()})},{default:(0,t.w5)((()=>[(0,t.Uk)("保存")])),_:1},8,["loading"])])])),_:1},8,["title","modelValue","before-close"])])),_:1})])}r(7658);var d=r(4853),c=r(6476),p=r(435),h=r(777),g=r(4239),w=r(7178),f=r(2655),T=r(1120);const P=async(e,s,r)=>{const t={userId:"",userName:"",userPassword:"",userPower:"",createTime:"",updateTime:""};t.userName=e.userName,t.userPassword=e.userPassword,t.userPower=Number(e.userPower);const a=(0,c.E)();if("添加"==r){t.userId="后端处理userId",t.createTime=a,t.updateTime=a;try{const e=await(0,p.v)("miseruser/addUser",t);"success"===e?.msg?(w.z8.success("添加成功！"),s()):"用户名或密码过长"===e?.msg?w.z8.info("用户名或密码过长！"):"用户已存在"===e?.msg?w.z8.info("用户已存在！"):"请输入有效信息"===e?.msg?w.z8.info("请输入有效信息！"):w.z8.error("添加失败，请稍后再试！")}catch{w.z8.error("添加失败，请稍后再试！")}}else if("编辑"==r){t.userId=e.userId;try{const e=await(0,p.v)("miseruser/updateUser",t);"success"===e?.msg?(w.z8.success("更新成功！"),s(),t.userId==g.Z.state.userInfo.userId&&(w.z8.info("需要重新登录！"),sessionStorage.removeItem("isLogin"),sessionStorage.removeItem("userInfo"),T.Z.replace({name:"LoginView"}))):"用户名或密码过长"===e?.msg?w.z8.info("用户名或密码过长！"):"用户名已存在"===e?.msg?w.z8.info("用户名已存在！"):"请输入有效信息"===e?.msg?w.z8.info("请输入有效信息！"):w.z8.error("更新失败，请稍后再试！")}catch{w.z8.error("更新失败，请稍后再试！")}}},y=async(e,s)=>{try{const r=await(0,p.v)("miseruser/deleteUser",e);"success"===r?.msg?(w.z8.success("删除成功！"),s()):w.z8.error("删除失败，请稍后再试！")}catch{w.z8.error("删除失败，请稍后再试！")}},b=async(e,s,r)=>{let t=[];t.push(s.userId),f.T.confirm("确定要删除吗?","删除",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((()=>{y(t,r)})).catch((()=>{w.z8.info("已取消删除")}))},I=async(e,s)=>{if(0==e.length)w.z8.info("请选择需要删除的项！");else{let r=[];for(let s=0;s<e.length;s++)r.push(e[s].userId);f.T.confirm("确定要删除吗?","删除",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((()=>{y(r,s)})).catch((()=>{w.z8.info("已取消删除")}))}},W=e=>{r.e(138).then(r.bind(r,7138)).then((s=>{const r=[];for(let i=0;i<e.length;i++)delete e[i].id,r.push(e[i]);const t=["用户id","用户名称","用户密码","用户权限","创建时间","更新时间"],a=r.map((e=>Object.values(e)));s.export_json_to_excel({header:t,data:a,filename:"userList",autoWidth:!0,bookType:"xlsx"})}))};var _=JSON.parse('[{"userId":1,"userName":"丁真珍珠","userPassword":"asdhuaindaoj","userPower":2000,"createTime":"2022-11-03T06:14:08.000+0000","updateTime":"2022-11-03T06:14:10.000+0000"},{"userId":2,"userName":"谷圣人","userPassword":"kfcvme50","userPower":2001,"createTime":"2022-11-03T06:14:10.000+0000","updateTime":"2022-11-03T06:14:08.000+0000"},{"userId":3,"userName":"赛博顶针","userPassword":"ojwsuiwxu","userPower":2003,"createTime":"2018-11-03T06:14:08.000+0000","updateTime":"2022-11-03T06:14:08.000+0000"},{"userId":4,"userName":"考编丁真","userPassword":"sfefweger","userPower":2004,"createTime":"2022-11-03T06:14:12.000+0000","updateTime":"2022-11-03T06:14:08.000+0000"},{"userId":5,"userName":"赢学家","userPassword":"8r2930jd823","userPower":2005,"createTime":"2022-11-03T06:14:10.000+0000","updateTime":"2022-11-03T06:14:01.000+0000"},{"userId":6,"userName":"丁真珍珠","userPassword":"scuyyds","userPower":2006,"createTime":"2022-11-03T06:14:12.000+0000","updateTime":"2022-11-03T06:14:01.000+0000"},{"userId":7,"userName":"考编丁真","userPassword":"edwedewved","userPower":2007,"createTime":"2022-11-03T06:14:12.000+0000","updateTime":"2022-11-03T06:14:01.000+0000"},{"userId":8,"userName":"赢学家","userPassword":"ifjweimicw","userPower":2008,"createTime":"2022-11-03T06:14:12.000+0000","updateTime":"2022-11-03T06:14:01.000+0000"},{"userId":9,"userName":"丁真珍珠","userPassword":"xxxxsb","userPower":2009,"createTime":"2022-11-03T06:14:12.000+0000","updateTime":"2022-11-03T06:14:01.000+0000"},{"userId":10,"userName":"赢学家","userPassword":"8j8hduh","userPower":2010,"createTime":"2022-11-03T06:14:12.000+0000","updateTime":"2022-11-03T06:14:01.000+0000"},{"userId":11,"userName":"丁真珍珠","userPassword":"yydz","userPower":2007,"createTime":"2022-11-03T06:14:12.000+0000","updateTime":"2022-11-03T06:14:01.000+0000"}]'),z={name:"MiserUser",components:{PaginateView:h.Z},data(){return{loading:!1,formInline:{page:1,limit:10},query:"",pageparm:{currentPage:1,pageSize:10,total:0},column:"",userList:[],title:"添加",editFormVisible:!1,editForm:{userId:"",userName:"",userPassword:"",userPower:"",createTime:""},rules:{userName:[{required:!0,message:"请输入用户名称",trigger:"blur"}],userPassword:[{required:!0,message:"请输入用户密码",trigger:"blur"}],userPower:[{required:!0,message:"请输入用户权限",trigger:"blur"},{type:"number",message:"必须是数字",trigger:"blur"}]},sels:[]}},created(){this.showUser()},methods:{async getUserList(){this.userList=_,this.loading=!1,this.pageparm.currentPage=this.formInline.page,this.pageparm.pageSize=this.formInline.limit,this.pageparm.total=this.userList.length},async getUser(e){if(this.userList=[],""!=e)try{const s=await(0,p.U)(`miseruser/getUser/${e}`);"success"===s?.msg&&s?.userInfo?(this.userList.push(s.userInfo),this.loading=!1,this.pageparm.currentPage=this.formInline.page,this.pageparm.pageSize=this.formInline.limit,this.pageparm.total=this.userList.length):"该用户信息不存在"===s?.msg?this.$message.info("该用户信息不存在！"):this.$message.error("未获取到数据，请重新输入！")}catch{this.$message.error("未获取到数据，请重新输入！")}else try{const e=await(0,p.U)("miseruser/getUserlist");"success"===e?.msg&&e?.userList?(this.userList=e.userList,this.loading=!1,this.pageparm.currentPage=this.formInline.page,this.pageparm.pageSize=this.formInline.limit,this.pageparm.total=this.userList.length):this.$message.error("未获取到数据，请重新获取！")}catch{this.$message.error("未获取到数据，请重新获取！")}},async showUser(){this.getUser(this.query)},selsChange(e){this.sels=e},singleDelete:b,batchDelete:I,async handleEdit(e,s){this.query="",this.editFormVisible=!0,void 0!=s&&"undefined"!=s?(this.title="编辑",this.editForm.userId=s.userId,this.editForm.userName=s.userName,this.editForm.userPassword=s.userPassword,this.editForm.userPower=s.userPower,this.editForm.createTime=(0,c.p)(s.createTime)):(this.title="添加",this.editForm.userId="",this.editForm.userName="",this.editForm.userPassword="",this.editForm.userPower="",this.editForm.createTime="")},submitForm:P,closeDialog(){this.editFormVisible=!1,this.$refs.editForm.resetFields()},callFather(e){this.formInline.page=e.currentPage,this.formInline.limit=e.pageSize,this.showUser(),this.sortChange(this.column)},handleExport:W,sortChange(e){this.column=e,this.userList=JSON.parse(JSON.stringify((0,d.Z)(e,this.userList)))},formatDate(e,s){let r=e[s.property];return(0,c.p)(r)}}},F=r(89);const C=(0,F.Z)(z,[["render",n],["__scopeId","data-v-0d195a8c"]]);var U=C}}]);
//# sourceMappingURL=90.e8034a3a.js.map