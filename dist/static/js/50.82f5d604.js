"use strict";(self["webpackChunkinventory_management_system"]=self["webpackChunkinventory_management_system"]||[]).push([[50],{1586:function(e,a,r){r.r(a),r.d(a,{default:function(){return P}});var t=r(3396);const i=e=>((0,t.dD)("data-v-7688a486"),e=e(),(0,t.Cn)(),e),o={class:"mainContainer"},l=i((()=>(0,t._)("span",null,"添加物品",-1))),s=i((()=>(0,t._)("span",null,"导出表格",-1))),m=i((()=>(0,t._)("span",null,"批量删除",-1))),n={"slot:footer":"",class:"dialog-footer",style:{"padding-left":"0.8rem"}},d={"slot:footer":"",class:"dialog-footer",style:{"padding-left":"0.5rem"}};function w(e,a,r,i,w,u){const c=(0,t.up)("el-breadcrumb-item"),p=(0,t.up)("el-breadcrumb"),h=(0,t.up)("el-button"),g=(0,t.up)("el-input"),f=(0,t.up)("el-col"),b=(0,t.up)("el-icon"),W=(0,t.up)("el-row"),C=(0,t.up)("el-table-column"),T=(0,t.up)("el-table"),y=(0,t.up)("PaginateView"),I=(0,t.up)("el-form-item"),z=(0,t.up)("el-form"),_=(0,t.up)("el-dialog"),N=(0,t.up)("el-input-number"),V=(0,t.up)("el-card"),F=(0,t.Q2)("loading");return(0,t.wg)(),(0,t.iD)("div",o,[(0,t.Wm)(p,{"separator-class":"el-icon-arrow-right"},{default:(0,t.w5)((()=>[(0,t.Wm)(c,{to:{path:"/"}},{default:(0,t.w5)((()=>[(0,t.Uk)("首页")])),_:1}),(0,t.Wm)(c,null,{default:(0,t.w5)((()=>[(0,t.Uk)("库存管理")])),_:1})])),_:1}),(0,t.Wm)(V,{class:"cardContainer"},{default:(0,t.w5)((()=>[(0,t.Wm)(W,{gutter:20},{default:(0,t.w5)((()=>[(0,t.Wm)(f,{span:7},{default:(0,t.w5)((()=>[(0,t.Wm)(g,{placeholder:"请输入物品id（默认筛选全部）",style:{position:"relative"},clearable:"",onClear:u.showWare,modelValue:w.query,"onUpdate:modelValue":a[0]||(a[0]=e=>w.query=e)},{append:(0,t.w5)((()=>[(0,t.Wm)(h,{type:"primary",class:"iconfont icon-sousuo",onClick:u.showWare},null,8,["onClick"])])),_:1},8,["onClear","modelValue"])])),_:1}),(0,t.Wm)(f,{span:3.5},{default:(0,t.w5)((()=>[(0,t.Wm)(h,{type:"primary",onClick:a[1]||(a[1]=e=>u.handleEdit())},{default:(0,t.w5)((()=>[(0,t.Wm)(b,{class:"iconfont icon-tianjiawupin"}),l])),_:1})])),_:1},8,["span"]),(0,t.Wm)(f,{span:3.5},{default:(0,t.w5)((()=>[(0,t.Wm)(h,{type:"primary",onClick:a[2]||(a[2]=e=>u.handleExport(w.wareList))},{default:(0,t.w5)((()=>[(0,t.Wm)(b,{class:"iconfont icon-daochubiaoge"}),s])),_:1})])),_:1},8,["span"]),(0,t.Wm)(f,{span:3.5},{default:(0,t.w5)((()=>[(0,t.Wm)(h,{type:"danger",onClick:a[3]||(a[3]=e=>u.batchDelete(w.sels,u.showWare))},{default:(0,t.w5)((()=>[(0,t.Wm)(b,{class:"iconfont icon-shanchupiliangshanchu"}),m])),_:1})])),_:1},8,["span"])])),_:1}),(0,t.wy)(((0,t.wg)(),(0,t.j4)(T,{height:"3.2rem",onSortChange:u.sortChange,onSelectionChange:u.selsChange,data:w.wareList.slice((w.pageparm.currentPage-1)*w.pageparm.pageSize,w.pageparm.currentPage*w.pageparm.pageSize),bware:"","element-loading-text":"拼命加载中",stripe:"",style:{margin:"0.15rem 0rem 0.15rem 0rem","max-height":"3.2rem"}},{default:(0,t.w5)((()=>[(0,t.Wm)(C,{align:"center",type:"selection",width:"60"}),(0,t.Wm)(C,{align:"center",label:"物品id",prop:"wareId","show-overflow-tooltip":!0,"min-width":"70"}),(0,t.Wm)(C,{align:"center",label:"物品名称",prop:"wareName","show-overflow-tooltip":!0,"min-width":"120"}),(0,t.Wm)(C,{align:"center",label:"物品价格",prop:"warePower","show-overflow-tooltip":!0,"min-width":"100",sortable:"custom"}),(0,t.Wm)(C,{align:"center",label:"库存数量",prop:"wareCount","show-overflow-tooltip":!0,"min-width":"100",sortable:"custom"}),(0,t.Wm)(C,{align:"center",label:"创建时间",prop:"createTime","show-overflow-tooltip":!0,formatter:u.formatDate,"min-width":"145",sortable:"custom"},null,8,["formatter"]),(0,t.Wm)(C,{align:"center",label:"更新时间",prop:"updateTime","show-overflow-tooltip":!0,formatter:u.formatDate,"min-width":"145",sortable:"custom"},null,8,["formatter"]),(0,t.Wm)(C,{align:"center",label:"操作","min-width":"175"},{default:(0,t.w5)((e=>[(0,t.Wm)(h,{size:"small",onClick:a=>u.handleEdit(e.$index,e.row)},{default:(0,t.w5)((()=>[(0,t.Uk)("编辑")])),_:2},1032,["onClick"]),(0,t.Wm)(h,{size:"small",type:"primary",onClick:a=>u.handleAddware(e.$index,e.row)},{default:(0,t.w5)((()=>[(0,t.Uk)("交易")])),_:2},1032,["onClick"]),(0,t.Wm)(h,{size:"small",type:"danger",onClick:a=>u.singleDelete(e.$index,e.row,u.showWare)},{default:(0,t.w5)((()=>[(0,t.Uk)("删除")])),_:2},1032,["onClick"])])),_:1})])),_:1},8,["onSortChange","onSelectionChange","data"])),[[F,w.loading]]),(0,t.Wm)(y,{"child-msg":w.pageparm,onCallFather:u.callFather},null,8,["child-msg","onCallFather"]),(0,t.Wm)(_,{title:w.title,modelValue:w.editFormVisible,"onUpdate:modelValue":a[8]||(a[8]=e=>w.editFormVisible=e),width:"30%","before-close":u.closeDialog},{default:(0,t.w5)((()=>[(0,t.Wm)(z,{"label-width":"1.2rem",model:w.editForm,rules:w.rules,ref:"editForm"},{default:(0,t.w5)((()=>[(0,t.Wm)(I,{label:"物品名称",prop:"wareName"},{default:(0,t.w5)((()=>[(0,t.Wm)(g,{size:"small",modelValue:w.editForm.wareName,"onUpdate:modelValue":a[4]||(a[4]=e=>w.editForm.wareName=e),"auto-complete":"off",placeholder:"请输入物品名称"},null,8,["modelValue"])])),_:1}),(0,t.Wm)(I,{label:"物品价格",prop:"warePower"},{default:(0,t.w5)((()=>[(0,t.Wm)(g,{size:"small",modelValue:w.editForm.warePower,"onUpdate:modelValue":a[5]||(a[5]=e=>w.editForm.warePower=e),modelModifiers:{number:!0},"auto-complete":"off",placeholder:"请输入物品价格"},null,8,["modelValue"])])),_:1}),(0,t.Wm)(I,{label:"库存数量",prop:"wareCount"},{default:(0,t.w5)((()=>[(0,t.Wm)(g,{size:"small",modelValue:w.editForm.wareCount,"onUpdate:modelValue":a[6]||(a[6]=e=>w.editForm.wareCount=e),modelModifiers:{number:!0},"auto-complete":"off",placeholder:"请输入库存数量"},null,8,["modelValue"])])),_:1})])),_:1},8,["model","rules"]),(0,t._)("div",n,[(0,t.Wm)(h,{style:{"margin-right":"0.6rem"},size:"small",onClick:u.closeDialog},{default:(0,t.w5)((()=>[(0,t.Uk)("取消")])),_:1},8,["onClick"]),(0,t.Wm)(h,{size:"small",type:"primary",loading:w.loading,class:"title",onClick:a[7]||(a[7]=e=>{u.submitForm(w.editForm,u.showWare,w.title),u.closeDialog()})},{default:(0,t.w5)((()=>[(0,t.Uk)("保存")])),_:1},8,["loading"])])])),_:1},8,["title","modelValue","before-close"]),(0,t.Wm)(_,{title:"交易",modelValue:w.addwareVisible,"onUpdate:modelValue":a[14]||(a[14]=e=>w.addwareVisible=e),width:"30%","before-close":u.closewareDialog},{default:(0,t.w5)((()=>[(0,t.Wm)(z,{"label-width":"1.2rem",model:w.addware,ref:"addware"},{default:(0,t.w5)((()=>[(0,t.Wm)(I,{label:"物品id",prop:"wareId"},{default:(0,t.w5)((()=>[(0,t.Wm)(g,{size:"small",modelValue:w.addware.wareId,"onUpdate:modelValue":a[9]||(a[9]=e=>w.addware.wareId=e),"auto-complete":"off",disabled:!0},null,8,["modelValue"])])),_:1}),(0,t.Wm)(I,{label:"物品名称",prop:"wareName"},{default:(0,t.w5)((()=>[(0,t.Wm)(g,{size:"small",modelValue:w.addware.wareName,"onUpdate:modelValue":a[10]||(a[10]=e=>w.addware.wareName=e),"auto-complete":"off",disabled:!0},null,8,["modelValue"])])),_:1}),(0,t.Wm)(I,{label:"物品数量",prop:"wareCount"},{default:(0,t.w5)((()=>[(0,t.Wm)(N,{modelValue:w.addware.wareCount,"onUpdate:modelValue":a[11]||(a[11]=e=>w.addware.wareCount=e),size:"small",min:1},null,8,["modelValue"])])),_:1})])),_:1},8,["model"]),(0,t._)("div",d,[(0,t.Wm)(h,{size:"small",type:"primary",style:{"margin-right":"0.4rem"},onClick:a[12]||(a[12]=e=>{u.submitOrder(w.addware,"cart"),u.closewareDialog()})},{default:(0,t.w5)((()=>[(0,t.Uk)("加入临时订单")])),_:1}),(0,t.Wm)(h,{size:"small",type:"primary",loading:w.loading,onClick:a[13]||(a[13]=e=>{u.submitOrder(w.addware,"order",u.showWare),u.closewareDialog()})},{default:(0,t.w5)((()=>[(0,t.Uk)("直接加入订单")])),_:1},8,["loading"])])])),_:1},8,["modelValue","before-close"])])),_:1})])}r(7658);var u=r(4853),c=r(6476),p=r(435),h=r(777),g=r(7178),f=r(2655);const b=async(e,a,r)=>{const t={wareId:"",wareName:"",warePower:"",wareCount:"",createTime:"",updateTime:""};t.wareName=e.wareName,t.warePower=Number(e.warePower),t.wareCount=Number(e.wareCount);const i=(0,c.E)();if("添加"==r){t.wareId="后端处理wareId",t.createTime=i,t.updateTime=i;try{const e=await(0,p.v)("miserware/addware",t);"success"===e?.msg?(g.z8.success("添加成功！"),a()):"物品名过长"===e?.msg?g.z8.info("物品名过长！"):"物品名已存在"===e?.msg?g.z8.info("物品名已存在！"):"请输入有效信息"===e?.msg?g.z8.info("请输入有效信息！"):g.z8.error("添加失败，请稍后再试！")}catch{g.z8.error("添加失败，请稍后再试！")}}else if("编辑"==r){t.wareId=e.wareId,t.createTime=e.createTime,t.updateTime=i;try{const e=await(0,p.v)("miserware/updateWare",t);"success"===e?.msg?(g.z8.success("更新成功！"),a()):"物品名过长"===e?.msg?g.z8.info("物品名过长！"):"物品名已存在"===e?.msg?g.z8.info("物品名已存在！"):"请输入有效信息"===e?.msg?g.z8.info("请输入有效信息！"):g.z8.error("更新失败，请稍后再试！")}catch{g.z8.error("更新失败，请稍后再试！")}}},W=async(e,a)=>{try{const r=await(0,p.v)("miserware/deleteWare",e);"success"===r?.msg?(g.z8.success("删除成功！"),a()):g.z8.error("删除失败，请稍后再试！")}catch{g.z8.error("删除失败，请稍后再试！")}},C=async(e,a,r)=>{let t=[];t.push(a.wareId),f.T.confirm("确定要删除吗?","删除",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((()=>{W(t,r)})).catch((()=>{g.z8.info("已取消删除")}))},T=async(e,a)=>{if(0==e.length)g.z8.info("请选择需要删除的项！");else{let r=[];for(let a=0;a<e.length;a++)r.push(e[a].wareId);f.T.confirm("确定要删除吗?","删除",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((()=>{W(r,a)})).catch((()=>{g.z8.info("已取消删除")}))}},y=e=>{r.e(138).then(r.bind(r,7138)).then((a=>{const r=[];for(let o=0;o<e.length;o++)delete e[o].id,r.push(e[o]);const t=["物品id","物品名称","物品价格","库存数量","创建时间","更新时间"],i=r.map((e=>Object.values(e)));a.export_json_to_excel({header:t,data:i,filename:"wareList",autoWidth:!0,bookType:"xlsx"})}))},I=async(e,a,r)=>{const t={userId:"",userName:"",wareId:"",wareName:"",wareCount:"",createTime:""},i=(0,c.E)();if(t.userId=e.userId,t.userName=e.userName,t.wareId=e.wareId,t.wareName=e.wareName,t.wareCount=e.wareCount,t.createTime=i,"cart"==a)try{const e=await(0,p.v)("misercart/addCart",t);"success"===e?.msg?g.z8.success("添加成功！"):"库存物品数量不足"===e?.msg?g.z8.info("库存物品数量不足！"):g.z8.error("添加失败，请稍后再试！")}catch{g.z8.error("添加失败，请稍后再试！")}else if("order"==a)try{const e=await(0,p.v)("miserorder/addOrder",t);"success"===e?.msg?(g.z8.success("添加成功！"),r()):"库存物品数量不足"===e?.msg?g.z8.info("库存物品数量不足！"):g.z8.error("添加失败，请稍后再试！")}catch{g.z8.error("添加失败，请稍后再试！")}};var z=I,_=JSON.parse('[{"wareId":1,"wareName":"丁真珍珠","warePower":12020703,"wareCount":10,"createTime":"2022-11-03T06:14:08.000+0000","updateTime":"2022-11-03T06:14:08.000+0000"},{"wareId":2,"wareName":"谷圣人","warePower":20020703,"wareCount":40,"createTime":"2022-11-03T06:14:11.000+0000","updateTime":"2022-11-03T06:14:12.000+0000"},{"wareId":3,"wareName":"赛博顶针","warePower":20020703,"wareCount":100,"createTime":"2022-11-03T06:14:13.000+0000","updateTime":"2022-11-03T06:14:11.000+0000"},{"wareId":4,"wareName":"考编丁真","warePower":20020703,"wareCount":10,"createTime":"2022-11-03T06:14:12.000+0000","updateTime":"2022-11-03T06:14:12.000+0000"},{"wareId":5,"wareName":"赢学家","warePower":34020703,"wareCount":100,"createTime":"2022-11-03T06:14:12.000+0000","updateTime":"2022-11-03T06:14:12.000+0000"},{"wareId":6,"wareName":"丁真珍珠","warePower":20020703,"wareCount":10,"createTime":"2022-11-03T06:14:10.000+0000","updateTime":"2022-11-03T06:14:12.000+0000"},{"wareId":7,"wareName":"考编丁真","warePower":20020703,"wareCount":10,"createTime":"2022-11-03T06:14:10.000+0000","updateTime":"2022-11-03T06:14:12.000+0000"},{"wareId":8,"wareName":"赢学家","warePower":20020703,"wareCount":100,"createTime":"2022-11-03T06:14:10.000+0000","updateTime":"2022-11-03T06:14:12.000+0000"},{"wareId":9,"wareName":"丁真珍珠","warePower":20020703,"wareCount":10,"createTime":"2022-11-03T06:14:12.000+0000","updateTime":"2022-11-03T06:14:12.000+0000"},{"wareId":10,"wareName":"赢学家","warePower":20020703,"wareCount":100,"createTime":"2022-11-03T06:14:14.000+0000","updateTime":"2022-11-03T06:14:12.000+0000"},{"wareId":11,"wareName":"丁真珍珠","warePower":25020703,"wareCount":10,"createTime":"2022-11-03T06:14:14.000+0000","updateTime":"2022-11-03T06:14:10.000+0000"}]'),N={name:"MiserWare",components:{PaginateView:h.Z},data(){return{loading:!1,formInline:{page:1,limit:10},query:"",pageparm:{currentPage:1,pageSize:10,total:0},column:"",wareList:[],title:"添加",editFormVisible:!1,editForm:{wareId:"",wareName:"",warePower:"",wareCount:"",createTime:""},rules:{wareName:[{required:!0,message:"请输入物品名称",trigger:"blur"}],warePower:[{required:!0,message:"请输入物品价格",trigger:"blur"},{type:"number",min:1,max:99999999,message:"必须是处于1-99999999区间的数字",trigger:"blur"}],wareCount:[{required:!0,message:"请输入库存数量",trigger:"blur"},{type:"number",min:1,max:9999999999,message:"必须是处于1-9999999999区间的数字",trigger:"blur"}]},addwareVisible:!1,addware:{userId:"",userName:"",wareId:"",wareName:"",wareCount:0},sels:[]}},created(){this.showWare()},methods:{async getWareList(){this.wareList=_,this.loading=!1,this.pageparm.currentPage=this.formInline.page,this.pageparm.pageSize=this.formInline.limit,this.pageparm.total=this.wareList.length},async getWare(e){if(this.wareList=[],""!=e)try{const a=await(0,p.U)(`miserware/getWare/${e}`);"success"===a?.msg&&a?.wareInfo?(this.wareList.push(a.wareInfo),this.loading=!1,this.pageparm.currentPage=this.formInline.page,this.pageparm.pageSize=this.formInline.limit,this.pageparm.total=this.wareList.length):"该物品信息不存在"===a?.msg?this.$message.info("该物品信息不存在！"):this.$message.error("未获取到数据，请重新输入！")}catch{this.$message.error("未获取到数据，请重新输入！")}else try{const e=await(0,p.U)("miserware/getWarelist");"success"===e?.msg&&e?.wareList?(this.wareList=e.wareList,this.loading=!1,this.pageparm.currentPage=this.formInline.page,this.pageparm.pageSize=this.formInline.limit,this.pageparm.total=this.wareList.length):this.$message.error("未获取到数据，请重新获取！")}catch{this.$message.error("未获取到数据，请重新获取！")}},async showWare(){this.getWare(this.query)},selsChange(e){this.sels=e},singleDelete:C,batchDelete:T,async handleEdit(e,a){this.query="",this.editFormVisible=!0,void 0!=a&&"undefined"!=a?(this.title="编辑",this.editForm.wareId=a.wareId,this.editForm.wareName=a.wareName,this.editForm.warePower=a.warePower,this.editForm.wareCount=a.wareCount,this.editForm.createTime=(0,c.p)(a.createTime)):(this.title="添加",this.editForm.wareId="",this.editForm.wareName="",this.editForm.warePower="",this.editForm.wareCount="",this.editForm.createTime="")},submitForm:b,closeDialog(){this.editFormVisible=!1,this.$refs.editForm.resetFields()},async handleAddware(e,a){this.addwareVisible=!0,this.addware.wareId=a.wareId,this.addware.wareName=a.wareName,this.addware.wareCount=0,this.addware.userId=this.$store.state.userInfo.userId,this.addware.userName=this.$store.state.userInfo.userName},submitOrder:z,closewareDialog(){this.addwareVisible=!1,this.$refs.addware.resetFields()},callFather(e){this.formInline.page=e.currentPage,this.formInline.limit=e.pageSize,this.showWare(),this.sortChange(this.column)},handleExport:y,sortChange(e){this.column=e,this.wareList=JSON.parse(JSON.stringify((0,u.Z)(e,this.wareList)))},formatDate(e,a){let r=e[a.property];return(0,c.p)(r)}}},V=r(89);const F=(0,V.Z)(N,[["render",w],["__scopeId","data-v-7688a486"]]);var P=F}}]);
//# sourceMappingURL=50.82f5d604.js.map